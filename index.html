<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact — FormBridge</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#2dd4bf; --accent-2:#2563eb;
      --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.03);
    }
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#041025 0%, #071426 60%);
      color:#e6eef6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      display:flex; align-items:center; justify-content:center; padding:32px;
    }

    .layout{width:100%;max-width:1100px;display:grid;grid-template-columns:1fr 420px;gap:28px;align-items:start}
    @media (max-width:980px){ .layout{ grid-template-columns: 1fr; padding: 20px } }

    /* Left: card with form */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015));
      border-radius:14px;padding:28px;border:1px solid rgba(255,255,255,0.04);
      box-shadow: 0 20px 50px rgba(2,6,23,0.6); transform: translateY(0); transition: transform .35s ease;
    }
    .card:hover{ transform: translateY(-6px) }

    h1{margin:0 0 8px 0;font-size:22px;letter-spacing:0.2px}
    p.lead{margin:0 0 18px 0;color:var(--muted);font-size:14px}

    label{display:block;margin-top:12px;color:#cfe7ff;font-size:13px;font-weight:600}
    input, textarea, select {
      width:100%; margin-top:6px; padding:12px 14px; border-radius:10px;
      background:var(--glass); border:1px solid rgba(255,255,255,0.03); color: #dff3ff;
      font-size:14px; outline:none; transition: box-shadow .18s, transform .12s;
    }
    textarea{min-height:120px;resize:vertical}
    input:focus, textarea:focus, select:focus { box-shadow: 0 6px 18px rgba(37,99,235,0.08); transform: translateY(-1px) }

    .row{display:flex;gap:12px}
    .row > *{flex:1}

    .send-bar{display:flex; align-items:center; gap:12px; margin-top:16px}
    button{
      background: linear-gradient(180deg,var(--accent-2), #1e40af);
      border:none;padding:12px 18px;border-radius:10px;color:white;font-weight:700;cursor:pointer;
      box-shadow: 0 8px 30px rgba(37,99,235,0.12); transition: transform .12s ease, opacity .12s;
    }
    button:hover{ transform: translateY(-2px) }
    button[disabled]{ opacity:.55; cursor:not-allowed; transform:none; box-shadow:none }

    .status{font-size:14px;margin-left:8px;color:var(--muted)}

    /* right column meta / cards */
    .meta-col{display:flex;flex-direction:column;gap:14px}
    .mini{background:var(--glass-2);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .mini h3{margin:0;font-size:13px}
    .mini p{margin:6px 0 0 0;color:var(--muted);font-size:13px}

    /* toast */
    .toast {
      position: fixed; right:20px; bottom:20px; z-index:1200;
      display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:10px;
      background: linear-gradient(90deg,#042b2b,#0b2440); color:#ecfdf5; box-shadow: 0 12px 40px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.04); transform: translateY(25px) scale(.98); opacity:0; pointer-events:none;
      transition:all .28s cubic-bezier(.2,.9,.2,1);
    }
    .toast.show{ transform: none; opacity:1; pointer-events:auto }

    .tick{
      width:36px;height:36px;border-radius:9px;background:linear-gradient(180deg,#064e3b,#044d3f);
      display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:#7fffd6;
      box-shadow: 0 8px 20px rgba(2,6,23,0.45);
    }

    .muted-small{font-size:13px;color:var(--muted)}

    /* subtle entrance */
    .layout{opacity:0; transform: translateY(6px); animation:fadeUp .6s .12s forwards}
    @keyframes fadeUp { to { opacity:1; transform:none } }

    /* little bounce for success */
    .pulse { animation: pulse 1s ease; }
    @keyframes pulse { 0%{ transform:scale(1) } 50%{ transform:scale(1.03) } 100%{ transform:scale(1) } }
  </style>
</head>
<body>
  <div class="layout">
    <div class="card" aria-live="polite">
      <h1>Contact us</h1>
      <p class="lead">Send a message and the project admin will receive it. (We do the rest.)</p>

      <label for="name">Name</label>
      <input id="name" placeholder="Your full name" autocomplete="name"/>

      <label for="email">Email</label>
      <input id="email" placeholder="you@example.com" type="email" autocomplete="email"/>

      <label for="topic">Topic</label>
      <select id="topic" aria-label="Topic">
        <option value="general">General</option>
        <option value="bug">Bug report</option>
        <option value="feature">Feature request</option>
      </select>

      <label for="message">Message</label>
      <textarea id="message" rows="6" placeholder="Type your message..."></textarea>

      <div class="send-bar">
        <button id="send">Send Message</button>
        <div id="status" class="status muted-small">Ready</div>
      </div>

      <div class="muted-small" style="margin-top:10px">Tip: You'll receive a confirmation in your inbox if configured.</div>
    </div>

    <aside class="meta-col">
      <div class="mini">
        <h3>Why FormBridge?</h3>
        <p class="muted-small">Simple serverless contact form that stores submissions in DynamoDB and forwards via SES.</p>
      </div>

      <div class="mini">
        <h3>Last action</h3>
        <p id="meta" class="muted-small">No requests yet</p>
      </div>

      <div class="mini">
        <h3>Status</h3>
        <p id="meta2" class="muted-small">Backend: operational ✓</p>
      </div>
    </aside>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true">
    <div class="tick">✓</div>
    <div>
      <div id="toast-title" style="font-weight:700">Message sent</div>
      <div id="toast-sub" style="font-size:13px;color:#bfe9e2">We've queued your message.</div>
    </div>
  </div>

  <script>
    // ---------- CONFIG ----------
    // set this to your API invoke URL
    const API_ENDPOINT = "https://12mse3zde5.execute-api.ap-south-1.amazonaws.com/Prod/submit";
    // ----------------------------

    const sendBtn = document.getElementById('send');
    const statusEl = document.getElementById('status');
    const metaEl = document.getElementById('meta');
    const toast = document.getElementById('toast');
    const toastSub = document.getElementById('toast-sub');

    function showToast(title, sub){
      document.getElementById('toast-title').textContent = title || 'Message sent';
      toastSub.textContent = sub || 'We queued your message.';
      toast.classList.add('show','pulse');
      setTimeout(()=> toast.classList.remove('pulse'), 900);
      // hide after 6s
      clearTimeout(toast._hideTimer);
      toast._hideTimer = setTimeout(()=> toast.classList.remove('show'), 6000);
    }

    function setStatus(text){
      statusEl.textContent = text;
    }

    async function sendRequest(payload){
      // send in background but return promise so we can debug/log
      try {
        const controller = new AbortController();
        const t = setTimeout(()=>controller.abort(), 15000);

        const resp = await fetch(API_ENDPOINT, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload),
          mode: 'cors',
          signal: controller.signal
        });

        clearTimeout(t);
        const txt = await resp.text();
        let data;
        try { data = txt ? JSON.parse(txt) : {}; } catch(e) { data = {raw:txt}; }
        return { ok: resp.ok, status: resp.status, data, headers: resp.headers };
      } catch (err) {
        // network/CORS/timeouts show up here
        console.error('Background send error:', err);
        return { ok:false, error: String(err) };
      }
    }

    sendBtn.addEventListener('click', async () => {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const topic = document.getElementById('topic').value;
      const message = document.getElementById('message').value.trim();

      if (!name || !email || !message) {
        setStatus('Please fill all fields.');
        return;
      }

      // optimistic UI: show success immediately (you requested this)
      sendBtn.disabled = true;
      setStatus('Sending...');
      showToast('Message sent', 'We are delivering your message.');

      // optionally clear the form visually
      document.getElementById('name').value = '';
      document.getElementById('email').value = '';
      document.getElementById('message').value = '';
      document.getElementById('topic').value = 'general';

      // update small meta
      const sentAt = new Date().toLocaleString();
      metaEl.textContent = `Sent (optimistic) • ${sentAt}`;

      // Fire the real background request but do not block the UI:
      const payload = { name, email, topic, message };
      sendRequest(payload).then(result => {
        if (result.ok) {
          // we got 2xx
          const id = result.data && (result.data.id || result.data.ID || result.data.Id);
          if (id) metaEl.textContent = `Sent ✓ (id: ${id}) • ${new Date().toLocaleString()}`;
          else metaEl.textContent = `Sent ✓ • ${new Date().toLocaleString()}`;
          setStatus('Message sent ✓');
        } else {
          // if there was an error, log and show meta for debugging
          console.error('Send result:', result);
          metaEl.textContent = `Network/Server issue — check console`;
          setStatus('Message queued (but delivery problem).');
          // Keep optimistic success visible but also open console note
          showToast('Message queued', 'Delivery error — check console (devtools).');
        }
      }).finally(()=>{
        // re-enable button after a short delay so user can send another if needed
        setTimeout(()=> sendBtn.disabled = false, 900);
      });
    });

    // Quick helpful tip: if page served from a different origin than API,
    // browser will enforce CORS preflight. If you still see CORS errors in devtools:
    //  - confirm API has Access-Control-Allow-Origin matching your page origin (exact).
    //  - confirm you deployed the latest SAM template and API stage.
    //  - CloudFront or API Gateway caching can cause old responses; try an incognito window.
  </script>
</body>
</html>
